**Tristan Gomez**

# Strings 2 Challenge

### Description:

```
This executable prints an MD5 Hash on the screen when executed. Can you grab the exact flag?
Note: You don't need to run the executable!


What is the flag of which that MD5 gets generated?
```

I began by running `strings` on the executable. The output is below. There isn't anything useful for this challenge in the output.

```
!This program cannot be run in DOS mode.
Rich
.text
`.rdata
@.data
.CRT
@.rsrc
@.reloc
QZ^&
QXRh80@
TAhR
j0h 0@
We've been compromised!
%02x
ExitProcess
KERNEL32.dll
memset
memcpy
sprintf
ntdll.dll                                                                                                          
MessageBoxA                                                                                                        
USER32.dll                                                                                                         
plaintext2.exe                                                                                                     
??0MD5@@QAE@XZ                                                                                                     
?Decode@MD5@@CAXPAKPAEI@Z                                                                                          
?Encode@MD5@@CAXPAEPAKI@Z                                                                                          
?Final@MD5@@QAEXXZ                                                                                                 
?Init@MD5@@QAEXXZ                                                                                                  
?MD5Transform@MD5@@CAXQAKQAE@Z                                                                                     
?Update@MD5@@QAEXPAEI@Z                                                                                            
?digestMemory@MD5@@QAEPADPAEH@Z                                                                                    
?digestString@MD5@@QAEPADPAD@Z                                                                                     
?md5_hash@@YAPADPAD@Z                                                                                              
?writeToString@MD5@@QAEXXZ                                                                                         
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">                                          
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">                                                             
    <security>                                                                                                     
      <requestedPrivileges>
        <requestedExecutionLevel level="asInvoker" uiAccess="false"></requestedExecutionLevel>
      </requestedPrivileges>
    </security>
  </trustInfo>
</assembly>PAPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPAD
2X3d3l3z3
```

I decided to open this binary in the default tool of `ghidra`. I ran the default analysis options and this was the output of the analysis. Thankfully it doesn't matter that we are mising PDB data.

```
PDB> Incomplete PDB information (GUID/Signature and/or age) associated with this program.
Either the program is not a PE, or it was not compiled with debug information.
Windows x86 PE RTTI Analyzer> Couldn't find type info structure.
```

Looking at the `Symbol Tree` pane, I expanded the `Functions` folder and got this output.

```
entry
FUN_00402390
md5_hash
memcpy
memset
sprintf
```

`entry` seems like thge best place to start. Right at the top of this method are a ton of `MOV` instructions. It looks like some hex values are being loaded into some local variables. These hex values appear to be in the ASCII range.

```
004022b6 c6 45 d8 46     MOV        byte ptr [EBP + local_2c],0x46
004022ba c6 45 d9 4c     MOV        byte ptr [EBP + local_2b],0x4c
004022be c6 45 da 41     MOV        byte ptr [EBP + local_2a],0x41
004022c2 c6 45 db 47     MOV        byte ptr [EBP + local_29],0x47
004022c6 c6 45 dc 7b     MOV        byte ptr [EBP + local_28],0x7b
004022ca c6 45 dd 53     MOV        byte ptr [EBP + local_27],0x53
004022ce c6 45 de 54     MOV        byte ptr [EBP + local_26],0x54
004022d2 c6 45 df 41     MOV        byte ptr [EBP + local_25],0x41
004022d6 c6 45 e0 43     MOV        byte ptr [EBP + local_24],0x43
004022da c6 45 e1 4b     MOV        byte ptr [EBP + local_23],0x4b
004022de c6 45 e2 2d     MOV        byte ptr [EBP + local_22],0x2d
004022e2 c6 45 e3 53     MOV        byte ptr [EBP + local_21],0x53
004022e6 c6 45 e4 54     MOV        byte ptr [EBP + local_20],0x54
004022ea c6 45 e5 52     MOV        byte ptr [EBP + local_1f],0x52
004022ee c6 45 e6 49     MOV        byte ptr [EBP + local_1e],0x49
004022f2 c6 45 e7 4e     MOV        byte ptr [EBP + local_1d],0x4e
004022f6 c6 45 e8 47     MOV        byte ptr [EBP + local_1c],0x47
004022fa c6 45 e9 53     MOV        byte ptr [EBP + local_1b],0x53
004022fe c6 45 ea 2d     MOV        byte ptr [EBP + local_1a],0x2d
00402302 c6 45 eb 41     MOV        byte ptr [EBP + local_19],0x41
00402306 c6 45 ec 52     MOV        byte ptr [EBP + local_18],0x52
0040230a c6 45 ed 45     MOV        byte ptr [EBP + local_17],0x45
0040230e c6 45 ee 2d     MOV        byte ptr [EBP + local_16],0x2d
00402312 c6 45 ef 42     MOV        byte ptr [EBP + local_15],0x42
00402316 c6 45 f0 45     MOV        byte ptr [EBP + local_14],0x45
0040231a c6 45 f1 53     MOV        byte ptr [EBP + local_13],0x53
0040231e c6 45 f2 54     MOV        byte ptr [EBP + local_12],0x54
00402322 c6 45 f3 2d     MOV        byte ptr [EBP + local_11],0x2d
00402326 c6 45 f4 53     MOV        byte ptr [EBP + local_10],0x53
0040232a c6 45 f5 54     MOV        byte ptr [EBP + local_f],0x54
0040232e c6 45 f6 52     MOV        byte ptr [EBP + local_e],0x52
00402332 c6 45 f7 49     MOV        byte ptr [EBP + local_d],0x49
00402336 c6 45 f8 4e     MOV        byte ptr [EBP + local_c],0x4e
0040233a c6 45 f9 47     MOV        byte ptr [EBP + local_b],0x47
0040233e c6 45 fa 53     MOV        byte ptr [EBP + local_a],0x53
00402342 c6 45 fb 7d     MOV        byte ptr [EBP + local_9],0x7d

```

Converting the hex into ASCII results in the string `FLAG{STACK-STRINGS-ARE-BEST-STRINGS}`. Looks like we have our flag!
Onto the final challenge!
