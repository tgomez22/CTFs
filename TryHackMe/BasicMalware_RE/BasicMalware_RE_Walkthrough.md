**Tristan Gomez**

# Strings Challenge 1

### Description
```
This executable prints an MD5 Hash on the screen when executed. Can you grab the exact flag?

Note: You don't need to run the executable!
```

### Walkthrough

I first decided to run `strings` on the executable to see what low-hanging fruit I could find. I piped the output of `strings` into `1.txt` so that I could search the file for the flag at a later time. There were lots of hashed strings and other artifacts. There are a lot of flags in plain text. For example
```
...
FLAG{STATES-AND-NATURE-FIVE-ARTICLE}
FLAG{CITIZENS-ENGINEERING-INSTRUMENT-THEM-SHALL}
FLAG{ALL-WITHIN-RIGHT-CONSCIENCE-REPUBLICS}
FLAG{THE-SUPREME-THE-ACTIVE-CITIZENS}
FLAG{THE-RESPONSIBLE-WITHIN-SUPPORTING-SOVIETS}
FLAG{THE-WAR-PRODUCTIVITY-VESTED-ITSELF}
FLAG{THEIR-BOUNDARIES-WORK-DIRECTION-LEGISLATIVE}
FLAG{AND-APPROPRIATE-LAWS-SOCIALIST-AND}
FLAG{BILL-AUTONOMOUS-PRODUCTION-AND-COURTS}
FLAG{ADMINISTRATIVE-CAPACITY-AND-EXCEPT-AND}
FLAG{THEIR-AND-PRINCIPLES-USSR-USSR}
FLAG{SAME-SECURITY-SUBORDINATE-CITIZENS-ITS}
FLAG{EDUCATION-PROPERTY-DENOUNCE-CONCERNED-AREAS}
FLAG{PARTICIPATION-THE-PROMOTE-DETRIMENT-HONORABLE}
FLAG{HATRED-PURITY-SHALL-CONVERSATIONS-MINISTRIES}
FLAG{LABOUR-AND-FROM-DEPUTIES-STATE}
FLAG{SHALL-FORMED-THE-VOTE-PEOPLES}
FLAG{THE-INSTITUTIONS-OBLIGED-USSR-USSR}
FLAG{THE-ITS-FORCES-THE-THE}
FLAG{RELATING-AND-ALL-AND-NATIONS}
FLAG{CITIZENS-THE-STRIVE-BALLOT-UNCOMPROMISING}
...
```

So we seem to have a lot of fake flags to throw us off the trail. Let's do a deeper analysis in `Ghidra` using its `default tool`.
I ran my analysis using the basic preset options. After running the analysis, I saw an error
```
PDB> Incomplete PDB information (GUID/Signature and/or age) associated with this program.
Either the program is not a PE, or it was not compiled with debug information.
Windows x86 PE RTTI Analyzer> Couldn't find type info structure.
```

but this won't hamper our analysis. Click okay and push onward! <br />

Looking at the `Symbol Tree` dialog box, I expanded the `functions` directory and am greeted by

```
entry
FUN_00402300
md5_hash
memcpy
memset
sprintf
```
Both `entry` and `md5_hash` seem the most promising to me. Let's look at entry first. <br>
 
 `entry` begins at `0x004022b0`. Looking at this method in the disassembler, I can see 
 ```
 PUSH       EAX=>s_FLAG{CAN-I-MAKE-IT-ANYMORE-OBVIO_00424828
 ```
 
 In the decompiler view, I can see

```

undefined4 entry(void)

{
  char *lpText;
  
  lpText = md5_hash(PTR_s_FLAG{CAN-I-MAKE-IT-ANYMORE-OBVIO_00432294);
  MessageBoxA((HWND)0x0,lpText,"We\'ve been compromised!",0x30);
  ExitProcess(0);
  return 0;
}

 ```
 
 It seems as though our flag is something like `FLAG{CAN-I-MAKE-IT-ANYMORE-OBVIOUS}` but, I should still search `1.txt` with the pattern I found in the disassembler/decompiler in case the flag isn't exactly what I think it is. 
 Looks like there is only one string that matches the partial string we found. Enter the flag to solve the level.
 
 **FLAG: FLAG{CAN-I-MAKE-IT-ANYMORE-OBVIOUS}**
 
 Onto part 2!
 
 
 ##
 
